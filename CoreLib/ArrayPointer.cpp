#include "ArrayPointer.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayPointer::Add(void* pvData, int iType)
{
	STypedPointer*	psPtr;

	psPtr = __CArrayPointer::Add();
	psPtr->iType = iType;
	psPtr->pvData = pvData;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayPointer::Get(int iElementPos, void** pvData, int* iType)
{
	STypedPointer*	psPtr;

	psPtr = __CArrayPointer::Get(iElementPos);
	*pvData = psPtr->pvData;
	*iType = psPtr->iType;
}


//////////////////////////////////////////////////////////////////////////
//																		//
//																		//
//////////////////////////////////////////////////////////////////////////
void* CArrayPointer::GetPtr(int iElementPos)
{
	STypedPointer*	psPtr;

	psPtr = __CArrayPointer::Get(iElementPos);
	return psPtr->pvData;
}


//////////////////////////////////////////////////////////////////////////
//																		//
//																		//
//////////////////////////////////////////////////////////////////////////
void* CArrayPointer::SafeGetPtr(int iElementPos)
{
	if ((iElementPos < 0) || (iElementPos >= miUsedElements))
	{
		return NULL;
	}
	else
	{
		return GetPtr(iElementPos);
	}
}


//////////////////////////////////////////////////////////////////////////
//																		//
//																		//
//////////////////////////////////////////////////////////////////////////
int CArrayPointer::GetType(int iElementPos)
{
	STypedPointer*	psPtr;

	psPtr = __CArrayPointer::Get(iElementPos);
	return psPtr->iType;
}


//////////////////////////////////////////////////////////////////////////
//																		//
//																		//
//////////////////////////////////////////////////////////////////////////
int CArrayPointer::SafeGetType(int iElementPos)
{
	if ((iElementPos < 0) || (iElementPos >= miUsedElements))
	{
		return -1;
	}
	else
	{
		return GetType(iElementPos);
	}
}

